<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DEMO - Ai 科學建模氣候風險評估專家</title>
  <script>
    // Language support for demo page
    const demoLanguageData = {
      zh: {
        title: "AI 金融科技演示平台",
        subtitle: "體驗我們的 AI 驅動氣候風險評估和投資策略工具",
        portfolioLabel: "選擇您的投資組合",
        portfolioPlaceholder: "輸入投資組合名稱",
        backButton: "返回主頁",
        copyright: "© 2024 中山永續金融科技 AiFinTech Corp. 版權所有",
        options: {
          climate: {
            title: "氣候風險分析",
            desc: "深度分析氣候變化對投資組合的潛在影響"
          },
          portfolio: {
            title: "投資組合策略",
            desc: "基於 AI 演算法的智能投資策略建議"
          },
          quantitative: {
            title: "量化分析",
            desc: "精確的數據分析和風險量化評估"
          }
        }
      },
      en: {
        title: "AI FinTech Demonstration Platform",
        subtitle: "Experience our AI-driven climate risk assessment and investment strategy tools",
        portfolioLabel: "Select Your Portfolio",
        portfolioPlaceholder: "Enter portfolio name",
        backButton: "Back to Home",
        copyright: "© 2024 Zhongshan Sustainable FinTech AiFinTech Corp. All rights reserved",
        options: {
          climate: {
            title: "Climate Risk Analysis",
            desc: "Deep analysis of climate change's potential impact on portfolios"
          },
          portfolio: {
            title: "Portfolio Strategy",
            desc: "AI algorithm-based intelligent investment strategy recommendations"
          },
          quantitative: {
            title: "Quantitative Analysis",
            desc: "Precise data analysis and risk quantification assessment"
          }
        }
      }
    };

    // Detect language from URL or localStorage
    let currentDemoLanguage = 'zh';
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('lang')) {
      currentDemoLanguage = urlParams.get('lang');
    } else if (localStorage.getItem('language')) {
      currentDemoLanguage = localStorage.getItem('language');
    }
  </script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-color: #2C5F73;
      --secondary-color: #4A90A4;
      --accent-color: #7FB069;
      --text-dark: #2D3748;
      --bg-light: #F7FAFC;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--bg-light) 0%, #E2E8F0 100%);
      min-height: 100vh;
      padding: 2rem 0;
    }

    .demo-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(44, 95, 115, 0.1);
      overflow: hidden;
    }

    .demo-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      padding: 2rem;
      text-align: center;
    }

    .demo-header h1 {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .demo-header p {
      opacity: 0.9;
      margin: 0;
    }

    .demo-content {
      padding: 3rem 2rem;
    }

    .input-section {
      background: var(--bg-light);
      border-radius: 15px;
      padding: 2rem;
      margin-bottom: 2rem;
      border: 2px solid #E2E8F0;
    }

    .input-section label {
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
      display: block;
    }

    .form-control {
      border-radius: 10px;
      border: 2px solid #E2E8F0;
      padding: 0.75rem 1rem;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-control:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 0.2rem rgba(74, 144, 164, 0.25);
    }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .option-card {
      background: white;
      border: 2px solid #E2E8F0;
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--text-dark);
    }

    .option-card:hover {
      transform: translateY(-5px);
      border-color: var(--secondary-color);
      box-shadow: 0 10px 30px rgba(74, 144, 164, 0.2);
      color: var(--text-dark);
      text-decoration: none;
    }

    .option-card i {
      font-size: 3rem;
      color: var(--secondary-color);
      margin-bottom: 1rem;
    }

    .option-card h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .option-card p {
      font-size: 0.9rem;
      opacity: 0.7;
      margin: 0;
    }

    .back-button {
      background: var(--accent-color);
      color: white;
      border: none;
      border-radius: 10px;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      margin-top: 2rem;
    }

    .back-button:hover {
      background: #6BA055;
      color: white;
      text-decoration: none;
      transform: translateY(-2px);
    }

    .footer-section {
      text-align: center;
      padding: 1rem 2rem;
      background: var(--bg-light);
      color: #6B7280;
      font-size: 0.9rem;
    }

    @media (max-width: 768px) {
      .demo-container {
        margin: 0 1rem;
        border-radius: 15px;
      }

      .demo-content {
        padding: 2rem 1.5rem;
      }

      .options-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Ensure fullscreen modal covers everything on mobile and medium screens */
    @media (max-width: 991.98px) {
      /* Hide main content when modal is open */
      body.modal-open > * {
        display: none !important;
      }

      body.modal-open .modal {
        display: block !important;
      }

      body.modal-open .modal-backdrop {
        display: none !important;
      }

      body.modal-open {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        overflow: hidden !important;
        padding: 0 !important;
        margin: 0 !important;
      }

      .modal.show {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        z-index: 9999 !important;
        background: white !important;
      }

      .modal.show .modal-dialog {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100% !important;
        height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        max-width: none !important;
        max-height: none !important;
      }

      .modal.show .modal-content {
        height: 100% !important;
        width: 100% !important;
        border: none !important;
        border-radius: 0 !important;
        background: white !important;
        margin: 0 !important;
        padding: 0 !important;
      }

      .modal.show .modal-body {
        height: calc(100vh - 120px) !important;
        overflow-y: auto !important;
        padding: 1rem !important;
        margin: 0 !important;
      }

      .modal.show .modal-header {
        position: sticky !important;
        top: 0 !important;
        z-index: 10 !important;
      }

      .modal.show .modal-footer {
        position: sticky !important;
        bottom: 0 !important;
        z-index: 10 !important;
      }
    }
  </style>
</head>

<body>
  <div class="demo-container">
    <div class="demo-header">
      <h1><i class="fas fa-chart-line me-2"></i>AI 金融科技演示平台</h1>
      <p>體驗我們的 AI 驅動氣候風險評估和投資策略工具</p>
    </div>

    <div class="demo-content">
      <div class="input-section">
        <label for="portfolio-input">
          <i class="fas fa-briefcase me-2 text-primary"></i>選擇您的投資組合
        </label>
        <input type="text" class="form-control" id="portfolio-input" value="ESG_10US組合"
               placeholder="輸入投資組合名稱">
      </div>

      <div class="options-grid">
        <a href="cs/climateRisk.html" class="option-card">
          <i class="fas fa-cloud-rain"></i>
          <h3>氣候風險分析</h3>
          <p>深度分析氣候變化對投資組合的潛在影響</p>
        </a>

        <a href="cs/portfolioStrategy.html" class="option-card">
          <i class="fas fa-chart-pie"></i>
          <h3>投資組合策略</h3>
          <p>基於 AI 演算法的智能投資策略建議</p>
        </a>

        <a href="cs/quantitativeAnalysis.html" class="option-card">
          <i class="fas fa-calculator"></i>
          <h3>量化分析</h3>
          <p>精確的數據分析和風險量化評估</p>
        </a>
      </div>

      <div class="text-center">
        <a href="index.html" class="back-button">
          <i class="fas fa-arrow-left"></i>
          返回主頁
        </a>
      </div>
    </div>

    <div class="footer-section">
      <p>&copy; 2024 中山永續金融科技 AiFinTech Corp. 版權所有</p>
    </div>
  </div>

  <!-- Feature Demo Modal -->
  <div class="modal fade" id="featureModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">功能演示</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="modalContent">
          <!-- Dynamic content will be loaded here -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
          <button type="button" class="btn btn-primary" id="learnMoreBtn" onclick="showDetailedInfo()">了解更多</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Store current feature type for detailed info
    let currentFeatureType = '';

    function showFeature(type) {
      currentFeatureType = type; // Store the current feature type
      const modal = new bootstrap.Modal(document.getElementById('featureModal'));
      const modalTitle = document.getElementById('modalTitle');
      const modalContent = document.getElementById('modalContent');

      let title, content;

      switch(type) {
        case 'climate':
          title = '氣候風險分析';
          content = `
            <div class="text-center mb-4">
              <i class="fas fa-cloud-rain fa-4x text-primary mb-3"></i>
              <h4>氣候風險評估工具</h4>
            </div>
            <div class="row mb-4">
              <div class="col-md-6">
                <h6>主要功能：</h6>
                <ul>
                  <li>多情境氣候模擬 (RCP 2.6, 4.5, 8.5)</li>
                  <li>實時風險監控與預警</li>
                  <li>財務影響量化分析</li>
                  <li>TCFD法規遵循報告</li>
                </ul>
              </div>
              <div class="col-md-6">
                <h6>分析指標：</h6>
                <ul>
                  <li>碳足跡評估 (Scope 1-3)</li>
                  <li>極端天氣風險 (熱浪、洪水、乾旱)</li>
                  <li>轉型風險評估 (政策、技術、市場)</li>
                  <li>物理風險量化 (急性、慢性)</li>
                </ul>
              </div>
            </div>
            <div class="bg-light p-3 rounded">
              <h6>示例分析結果：</h6>
              <div class="row">
                <div class="col-4 text-center">
                  <div class="h5 text-danger">12.3%</div>
                  <small>高風險資產比例</small>
                </div>
                <div class="col-4 text-center">
                  <div class="h5 text-warning">$2.4M</div>
                  <small>潛在財務損失</small>
                </div>
                <div class="col-4 text-center">
                  <div class="h5 text-success">85%</div>
                  <small>法規遵循度</small>
                </div>
              </div>
            </div>
          `;
          break;
        case 'portfolio':
          title = '投資組合策略';
          content = `
            <div class="text-center mb-4">
              <i class="fas fa-chart-pie fa-4x text-success mb-3"></i>
              <h4>AI 驅動投資策略</h4>
            </div>
            <div class="row mb-4">
              <div class="col-md-6">
                <h6>策略特色：</h6>
                <ul>
                  <li>ESG x MoE 財務避險分析</li>
                  <li>多因子風險平衡配置</li>
                  <li>智能動態再平衡</li>
                  <li>行為金融增強優化</li>
                </ul>
              </div>
              <div class="col-md-6">
                <h6>技術優勢：</h6>
                <ul>
                  <li>深度學習預測模型</li>
                  <li>大數據情境分析</li>
                  <li>專家閉鎖演算法</li>
                  <li>即時市場輿情監控</li>
                </ul>
              </div>
            </div>
            <div class="bg-light p-3 rounded">
              <h6>ESG_10US組合 表現分析：</h6>
              <div class="row">
                <div class="col-3 text-center">
                  <div class="h5 text-success">+8.7%</div>
                  <small>年化報酬率</small>
                </div>
                <div class="col-3 text-center">
                  <div class="h5 text-info">0.82</div>
                  <small>夏普比率</small>
                </div>
                <div class="col-3 text-center">
                  <div class="h5 text-warning">-12.4%</div>
                  <small>最大回撤</small>
                </div>
                <div class="col-3 text-center">
                  <div class="h5 text-primary">A+</div>
                  <small>ESG評級</small>
                </div>
              </div>
            </div>
          `;
          break;
        case 'quantitative':
          title = '量化分析';
          content = `
            <div class="text-center mb-4">
              <i class="fas fa-calculator fa-4x text-warning mb-3"></i>
              <h4>精準量化評估</h4>
            </div>
            <div class="row mb-4">
              <div class="col-md-6">
                <h6>分析工具：</h6>
                <ul>
                  <li>VaR 風險價值 (95%/99% 信心水準)</li>
                  <li>蒙地卡羅壓力測試</li>
                  <li>因子相關性分析</li>
                  <li>歷史與參數回測驗證</li>
                </ul>
              </div>
              <div class="col-md-6">
                <h6>數據來源：</h6>
                <ul>
                  <li>即時全球市場數據</li>
                  <li>15年歷史價格資料</li>
                  <li>財務基本面數據</li>
                  <li>衛星與新聞替代數據</li>
                </ul>
              </div>
            </div>
            <div class="bg-light p-3 rounded mb-3">
              <h6>風險指標監控：</h6>
              <div class="row">
                <div class="col-4 text-center">
                  <div class="h5 text-danger">2.8%</div>
                  <small>1日VaR (95%)</small>
                </div>
                <div class="col-4 text-center">
                  <div class="h5 text-warning">15.2%</div>
                  <small>年化波動率</small>
                </div>
                <div class="col-4 text-center">
                  <div class="h5 text-info">0.74</div>
                  <small>Beta係數</small>
                </div>
              </div>
            </div>
            <div class="alert alert-info">
              <i class="fas fa-chart-line me-2"></i>
              <strong>實時分析：</strong> 基於大數據模組平台，整合產業市場輿情與氣候情境趨勢，提供精準的量化風險評估。
            </div>
          `;
          break;
      }

      modalTitle.textContent = title;
      modalContent.innerHTML = content;
      modal.show();
    }

    // Add smooth animations
    document.addEventListener('DOMContentLoaded', function() {
      const cards = document.querySelectorAll('.option-card');
      cards.forEach((card, index) => {
        card.style.animationDelay = `${index * 0.1}s`;
        card.style.animation = 'fadeInUp 0.6s ease forwards';
      });
    });

    // Function to show detailed information based on feature type
    function showDetailedInfo() {
      const existingModal = document.getElementById('detailModal');
      if (existingModal) {
        existingModal.remove();
      }

      let modalContent = '';
      let modalTitle = '';

      switch(currentFeatureType) {
        case 'climate':
          modalTitle = '投資組合加權平均碳強度調適';
          modalContent = `
            <!-- 投資組合加權平均碳強度調適 -->
            <section class="mb-4">
              <h4><i class="fas fa-leaf me-2 text-success"></i>投資組合加權平均碳強度調適</h4>
              <p class="lead">運用WACI (Weighted Average Carbon Intensity) 方法評估投資組合的碳風險暴露</p>

              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="card border-success">
                    <div class="card-header bg-success text-white">
                      <h6 class="mb-0"><i class="fas fa-calculator me-2"></i>WACI 計算公式</h6>
                    </div>
                    <div class="card-body">
                      <div class="text-center mb-3">
                        <code class="fs-5">WACI = Σ(wi × CIi)</code>
                      </div>
                      <ul class="list-unstyled">
                        <li><strong>wi:</strong> 公司 i 在投資組合中的權重</li>
                        <li><strong>CIi:</strong> 公司 i 的碳強度 (tCO2e/USD百萬)</li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="card border-info">
                    <div class="card-header bg-info text-white">
                      <h6 class="mb-0"><i class="fas fa-chart-bar me-2"></i>調適策略</h6>
                    </div>
                    <div class="card-body">
                      <ul>
                        <li>識別高碳強度資產</li>
                        <li>逐步降低碳密集型投資</li>
                        <li>增加低碳/零碳資產配置</li>
                        <li>設定碳強度目標軌道</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card mb-4">
                <div class="card-header bg-secondary text-white">
                  <h6 class="mb-0"><i class="fas fa-table me-2"></i>ESG_10US組合 碳強度分析表</h6>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <thead class="table-dark">
                        <tr>
                          <th>公司代碼</th>
                          <th>權重 (%)</th>
                          <th>碳強度 (tCO2e/M$)</th>
                          <th>加權碳強度</th>
                          <th>風險等級</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td><strong>AAPL</strong></td>
                          <td>12.5</td>
                          <td>8.3</td>
                          <td>1.04</td>
                          <td><span class="badge bg-success">低</span></td>
                        </tr>
                        <tr>
                          <td><strong>MSFT</strong></td>
                          <td>11.8</td>
                          <td>6.7</td>
                          <td>0.79</td>
                          <td><span class="badge bg-success">低</span></td>
                        </tr>
                        <tr>
                          <td><strong>NVDA</strong></td>
                          <td>10.2</td>
                          <td>15.6</td>
                          <td>1.59</td>
                          <td><span class="badge bg-warning">中</span></td>
                        </tr>
                        <tr>
                          <td><strong>TSLA</strong></td>
                          <td>9.8</td>
                          <td>12.4</td>
                          <td>1.22</td>
                          <td><span class="badge bg-warning">中</span></td>
                        </tr>
                        <tr>
                          <td><strong>META</strong></td>
                          <td>8.5</td>
                          <td>9.2</td>
                          <td>0.78</td>
                          <td><span class="badge bg-success">低</span></td>
                        </tr>
                        <tr>
                          <td><strong>GOOGL</strong></td>
                          <td>7.9</td>
                          <td>7.8</td>
                          <td>0.62</td>
                          <td><span class="badge bg-success">低</span></td>
                        </tr>
                        <tr>
                          <td><strong>TSM</strong></td>
                          <td>7.3</td>
                          <td>45.8</td>
                          <td>3.34</td>
                          <td><span class="badge bg-danger">高</span></td>
                        </tr>
                        <tr>
                          <td><strong>AVGO</strong></td>
                          <td>6.2</td>
                          <td>28.9</td>
                          <td>1.79</td>
                          <td><span class="badge bg-warning">中</span></td>
                        </tr>
                        <tr>
                          <td><strong>JPM</strong></td>
                          <td>5.8</td>
                          <td>35.2</td>
                          <td>2.04</td>
                          <td><span class="badge bg-danger">高</span></td>
                        </tr>
                        <tr>
                          <td><strong>CITI</strong></td>
                          <td>5.4</td>
                          <td>38.7</td>
                          <td>2.09</td>
                          <td><span class="badge bg-danger">高</span></td>
                        </tr>
                      </tbody>
                      <tfoot class="table-secondary">
                        <tr>
                          <th>總計</th>
                          <th>85.4%</th>
                          <th>-</th>
                          <th><strong>15.30</strong></th>
                          <th>調適目標: <span class="badge bg-primary">11.8</span></th>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>

              <div class="bg-light p-3 rounded">
                <h6>調適後目標結果：</h6>
                <div class="row">
                  <div class="col-3 text-center">
                    <div class="h5 text-warning">15.3</div>
                    <small>當前WACI值</small>
                  </div>
                  <div class="col-3 text-center">
                    <div class="h5 text-success">-23%</div>
                    <small>年度降幅目標</small>
                  </div>
                  <div class="col-3 text-center">
                    <div class="h5 text-primary">11.8</div>
                    <small>調適後WACI</small>
                  </div>
                  <div class="col-3 text-center">
                    <div class="h5 text-info">2030</div>
                    <small>淨零目標年</small>
                  </div>
                </div>
              </div>
            </section>
          `;
          break;

        case 'portfolio':
          modalTitle = 'ESG 投資組合調適策略';
          modalContent = `
            <!-- ESG 投資組合調適策略 -->
            <section class="mb-4">
              <h4><i class="fas fa-balance-scale me-2 text-primary"></i>ESG 投資組合調適策略</h4>
              <p class="lead">基於ESG評估和風險分析的投資組合優化建議</p>

              <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                  <h6 class="mb-0"><i class="fas fa-chart-pie me-2"></i>ESG_10US組合 財務表現分析 (2022 Q1 - 2025 Q1)</h6>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <thead class="table-dark">
                        <tr>
                          <th>公司</th>
                          <th>營收成長率 (%)</th>
                          <th>淨利率 (%)</th>
                          <th>EPS成長 (%)</th>
                          <th>ESG評級</th>
                          <th>建議動作</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="table-success">
                          <td><strong>NVDA</strong></td>
                          <td>+45.2</td>
                          <td>22.8</td>
                          <td>+68.5</td>
                          <td>B+</td>
                          <td><span class="badge bg-success">增持 +15%</span></td>
                        </tr>
                        <tr class="table-success">
                          <td><strong>TSLA</strong></td>
                          <td>+28.7</td>
                          <td>15.4</td>
                          <td>+42.3</td>
                          <td>A-</td>
                          <td><span class="badge bg-success">增持 +12%</span></td>
                        </tr>
                        <tr class="table-warning">
                          <td><strong>AAPL</strong></td>
                          <td>+8.3</td>
                          <td>21.2</td>
                          <td>+12.7</td>
                          <td>A</td>
                          <td><span class="badge bg-warning">持平</span></td>
                        </tr>
                        <tr class="table-warning">
                          <td><strong>MSFT</strong></td>
                          <td>+12.5</td>
                          <td>32.6</td>
                          <td>+18.9</td>
                          <td>A+</td>
                          <td><span class="badge bg-warning">持平</span></td>
                        </tr>
                        <tr class="table-warning">
                          <td><strong>META</strong></td>
                          <td>+6.8</td>
                          <td>18.7</td>
                          <td>+9.4</td>
                          <td>B</td>
                          <td><span class="badge bg-warning">持平</span></td>
                        </tr>
                        <tr class="table-info">
                          <td><strong>GOOGL</strong></td>
                          <td>+9.1</td>
                          <td>19.3</td>
                          <td>+14.2</td>
                          <td>A-</td>
                          <td><span class="badge bg-info">觀察</span></td>
                        </tr>
                        <tr class="table-danger">
                          <td><strong>TSM</strong></td>
                          <td>+4.2</td>
                          <td>41.8</td>
                          <td>+7.1</td>
                          <td>B+</td>
                          <td><span class="badge bg-danger">減持 -8%</span></td>
                        </tr>
                        <tr class="table-info">
                          <td><strong>AVGO</strong></td>
                          <td>+11.6</td>
                          <td>28.9</td>
                          <td>+15.8</td>
                          <td>B</td>
                          <td><span class="badge bg-info">觀察</span></td>
                        </tr>
                        <tr class="table-danger">
                          <td><strong>JPM</strong></td>
                          <td>+2.8</td>
                          <td>24.1</td>
                          <td>+3.5</td>
                          <td>B-</td>
                          <td><span class="badge bg-danger">減持 -5%</span></td>
                        </tr>
                        <tr class="table-danger">
                          <td><strong>CITI</strong></td>
                          <td>+1.9</td>
                          <td>18.7</td>
                          <td>+2.1</td>
                          <td>C+</td>
                          <td><span class="badge bg-danger">減持 -5%</span></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>

              <div class="row mb-4">
                <div class="col-md-4">
                  <div class="card border-success">
                    <div class="card-header bg-success text-white text-center">
                      <h6 class="mb-0">關鍵增持理由</h6>
                    </div>
                    <div class="card-body">
                      <div class="mb-3">
                        <strong>NVDA:</strong>
                        <ul class="small mt-2">
                          <li>AI晶片市場領先地位</li>
                          <li>數據中心需求強勁</li>
                          <li>技術創新持續領先</li>
                        </ul>
                      </div>
                      <div>
                        <strong>TSLA:</strong>
                        <ul class="small mt-2">
                          <li>電動車市場快速擴張</li>
                          <li>符合ESG永續目標</li>
                          <li>自動駕駛技術優勢</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card border-warning">
                    <div class="card-header bg-warning text-white text-center">
                      <h6 class="mb-0">風險評估重點</h6>
                    </div>
                    <div class="card-body">
                      <div class="mb-3">
                        <strong>地緣政治風險:</strong>
                        <ul class="small mt-2">
                          <li>TSM: 台海關係緊張</li>
                          <li>供應鏈中斷風險</li>
                        </ul>
                      </div>
                      <div>
                        <strong>產業轉型風險:</strong>
                        <ul class="small mt-2">
                          <li>傳統銀行業數位化</li>
                          <li>法規環境變化</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card border-info">
                    <div class="card-header bg-info text-white text-center">
                      <h6 class="mb-0">調適策略效果</h6>
                    </div>
                    <div class="card-body text-center">
                      <div class="mb-3">
                        <div class="h5 text-success">+2.3%</div>
                        <small>預期年化報酬提升</small>
                      </div>
                      <div class="mb-3">
                        <div class="h5 text-primary">A</div>
                        <small>調適後ESG評級</small>
                      </div>
                      <div>
                        <div class="h5 text-warning">-15%</div>
                        <small>風險暴露降低</small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="alert alert-info">
                <h6><i class="fas fa-lightbulb me-2"></i>調適策略核心原則</h6>
                <div class="row">
                  <div class="col-md-6">
                    <ul class="mb-0">
                      <li>平衡財務回報與ESG風險</li>
                      <li>聚焦高成長潛力產業</li>
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <ul class="mb-0">
                      <li>降低地緣政治風險暴露</li>
                      <li>提升組合永續性評級</li>
                    </ul>
                  </div>
                </div>
              </div>
            </section>
          `;
          break;

        case 'quantitative':
          modalTitle = 'TSMC 衝擊後走勢分析';
          modalContent = `
            <!-- TSMC 衝擊後走勢圖 -->
            <section class="mb-4">
              <h4><i class="fas fa-chart-line me-2 text-danger"></i>TSMC 衝擊後走勢分析</h4>
              <p class="lead">深度分析2025年初TSMC股價受多重外部事件影響的完整軌跡</p>

              <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                  <h6 class="mb-0"><i class="fas fa-chart-area me-2"></i>TSMC 股價走勢圖</h6>
                </div>
                <div class="card-body">
                  <div class="chart-container" style="position: relative; height: 400px; width: 100%;">
                    <canvas id="tsmcChart" style="background: #f8f9fa; border-radius: 8px;"></canvas>
                  </div>
                  <div class="row mt-3">
                    <div class="col-6 col-md-3 text-center">
                      <div class="p-2 bg-light rounded">
                        <div class="small text-muted">起始價格</div>
                        <div class="fw-bold text-primary">1120</div>
                      </div>
                    </div>
                    <div class="col-6 col-md-3 text-center">
                      <div class="p-2 bg-light rounded">
                        <div class="small text-muted">最低點</div>
                        <div class="fw-bold text-danger">1035</div>
                      </div>
                    </div>
                    <div class="col-6 col-md-3 text-center">
                      <div class="p-2 bg-light rounded">
                        <div class="small text-muted">結束價格</div>
                        <div class="fw-bold text-info">1040</div>
                      </div>
                    </div>
                    <div class="col-6 col-md-3 text-center">
                      <div class="p-2 bg-light rounded">
                        <div class="small text-muted">總跌幅</div>
                        <div class="fw-bold text-danger">-7.14%</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card mb-4">
                <div class="card-header bg-secondary text-white">
                  <h6 class="mb-0"><i class="fas fa-table me-2"></i>TSMC 股價與交易量詳細數據表</h6>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <thead class="table-dark">
                        <tr>
                          <th>日期</th>
                          <th>股價 (TWD)</th>
                          <th>日漲跌</th>
                          <th>漲跌幅 (%)</th>
                          <th>交易量 (千股)</th>
                          <th>關鍵事件</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td><strong>2025/01/20</strong></td>
                          <td>1120</td>
                          <td>-</td>
                          <td>-</td>
                          <td>45,231</td>
                          <td><span class="badge bg-primary">起始基準</span></td>
                        </tr>
                        <tr class="table-danger">
                          <td><strong>2025/01/21</strong></td>
                          <td>1095</td>
                          <td>-25</td>
                          <td>-2.23</td>
                          <td>24,369</td>
                          <td><span class="badge bg-danger">地震影響</span></td>
                        </tr>
                        <tr>
                          <td><strong>2025/01/28</strong></td>
                          <td>1108</td>
                          <td>+13</td>
                          <td>+1.19</td>
                          <td>38,642</td>
                          <td><span class="badge bg-success">短期反彈</span></td>
                        </tr>
                        <tr class="table-warning">
                          <td><strong>2025/02/03</strong></td>
                          <td>1058</td>
                          <td>-50</td>
                          <td>-4.51</td>
                          <td>113,032</td>
                          <td><span class="badge bg-warning">MSCI權重評估</span></td>
                        </tr>
                        <tr>
                          <td><strong>2025/02/07</strong></td>
                          <td>1071</td>
                          <td>+13</td>
                          <td>+1.23</td>
                          <td>67,458</td>
                          <td><span class="badge bg-info">技術反彈</span></td>
                        </tr>
                        <tr class="table-warning">
                          <td><strong>2025/02/10</strong></td>
                          <td>1056</td>
                          <td>-15</td>
                          <td>-1.40</td>
                          <td>89,237</td>
                          <td><span class="badge bg-warning">MSCI權重調整</span></td>
                        </tr>
                        <tr>
                          <td><strong>2025/02/14</strong></td>
                          <td>1048</td>
                          <td>-8</td>
                          <td>-0.76</td>
                          <td>52,341</td>
                          <td><span class="badge bg-secondary">持續壓力</span></td>
                        </tr>
                        <tr>
                          <td><strong>2025/02/20</strong></td>
                          <td>1035</td>
                          <td>-13</td>
                          <td>-1.24</td>
                          <td>71,829</td>
                          <td><span class="badge bg-secondary">下跌趨勢</span></td>
                        </tr>
                        <tr class="table-danger">
                          <td><strong>2025/02/27</strong></td>
                          <td>1040</td>
                          <td>+5</td>
                          <td>+0.48</td>
                          <td>45,726</td>
                          <td><span class="badge bg-info">期末收盤</span></td>
                        </tr>
                      </tbody>
                      <tfoot class="table-secondary">
                        <tr>
                          <th>總結</th>
                          <th><strong>1040</strong></th>
                          <th><strong>-80</strong></th>
                          <th><strong>-7.14%</strong></th>
                          <th>平均: 60,629</th>
                          <th><span class="badge bg-danger">淨下跌</span></th>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>

              <div class="row mb-4">
                <div class="col-md-8">
                  <div class="card">
                    <div class="card-header bg-primary text-white">
                      <h6 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>關鍵事件影響分析</h6>
                    </div>
                    <div class="card-body">
                      <div class="timeline">
                        <div class="d-flex mb-3 align-items-center">
                          <span class="badge bg-danger me-3 p-2">01/21</span>
                          <div>
                            <strong>地震衝擊事件:</strong>
                            <p class="mb-1 small">股價單日下跌2.23%，交易量萎縮至24,369千股</p>
                            <p class="mb-0 small text-muted">市場對生產中斷的擔憂導致拋售</p>
                          </div>
                        </div>
                        <div class="d-flex mb-3 align-items-center">
                          <span class="badge bg-warning me-3 p-2">02/03</span>
                          <div>
                            <strong>MSCI權重評估:</strong>
                            <p class="mb-1 small">重挫4.51%，交易量暴增至113,032千股</p>
                            <p class="mb-0 small text-muted">被動基金贖回壓力，外資大量出場</p>
                          </div>
                        </div>
                        <div class="d-flex mb-3 align-items-center">
                          <span class="badge bg-info me-3 p-2">02/10</span>
                          <div>
                            <strong>MSCI權重調整:</strong>
                            <p class="mb-1 small">再跌1.40%，交易量維持高檔89,237千股</p>
                            <p class="mb-0 small text-muted">權重正式調降，結構性賣壓出現</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card border-warning">
                    <div class="card-header bg-warning text-white">
                      <h6 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>量化影響評估</h6>
                    </div>
                    <div class="card-body">
                      <div class="mb-3 text-center">
                        <div class="h4 text-danger">-7.14%</div>
                        <small>總體跌幅</small>
                      </div>
                      <div class="mb-3 text-center">
                        <div class="h5 text-warning">38天</div>
                        <small>影響週期</small>
                      </div>
                      <div class="mb-3 text-center">
                        <div class="h6 text-primary">60.6K</div>
                        <small>日均交易量</small>
                      </div>
                      <div class="text-center">
                        <div class="h6 text-info">2.4%</div>
                        <small>日均波動率</small>
                      </div>
                    </div>
                  </div>

                  <div class="card border-info mt-3">
                    <div class="card-header bg-info text-white">
                      <h6 class="mb-0"><i class="fas fa-chart-area me-2"></i>技術指標</h6>
                    </div>
                    <div class="card-body">
                      <div class="mb-2">
                        <small class="text-muted">支撐位</small>
                        <div class="fw-bold">1035</div>
                      </div>
                      <div class="mb-2">
                        <small class="text-muted">阻力位</small>
                        <div class="fw-bold">1108</div>
                      </div>
                      <div class="mb-2">
                        <small class="text-muted">RSI</small>
                        <div class="fw-bold text-danger">28.5 (超賣)</div>
                      </div>
                      <div>
                        <small class="text-muted">MACD</small>
                        <div class="fw-bold text-danger">負向發散</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="alert alert-warning">
                <h6><i class="fas fa-chart-line me-2"></i>後續展望與風險監控</h6>
                <div class="row">
                  <div class="col-md-6">
                    <strong>關注重點:</strong>
                    <ul class="mb-0">
                      <li>地緣政治風險持續監控</li>
                      <li>MSCI權重調整後續影響</li>
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <strong>復甦訊號:</strong>
                    <ul class="mb-0">
                      <li>交易量回歸正常水準</li>
                      <li>技術指標脫離超賣區間</li>
                    </ul>
                  </div>
                </div>
              </div>
            </section>
          `;
          break;

        default:
          modalTitle = '詳細資訊';
          modalContent = '<p>請先選擇一個功能模組以查看詳細資訊。</p>';
      }

      const modalHTML = `
        <div class="modal fade" id="detailModal" tabindex="-1">
          <div class="modal-dialog modal-xl modal-fullscreen-lg-down">
            <div class="modal-content">
              <div class="modal-header" style="background: linear-gradient(135deg, #2C5F73 0%, #4A90A4 100%); color: white;">
                <h5 class="modal-title"><i class="fas fa-chart-line me-2"></i>${modalTitle}</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body" style="max-height: 80vh; overflow-y: auto;">
                ${modalContent}
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                  <i class="fas fa-times me-2"></i>關閉
                </button>
              </div>
            </div>
          </div>
        </div>
      `;

      document.body.insertAdjacentHTML('beforeend', modalHTML);
      const modal = new bootstrap.Modal(document.getElementById('detailModal'));
      const detailModalElement = document.getElementById('detailModal');

      // Handle mobile and medium screen fullscreen behavior
      detailModalElement.addEventListener('show.bs.modal', function() {
        // Check if mobile or medium screen
        if (window.innerWidth <= 991.98) {
          // Add class immediately for mobile and medium screen
          document.body.classList.add('modal-open');

          // Force complete fullscreen
          setTimeout(() => {
            document.body.style.cssText = `
              position: fixed !important;
              top: 0 !important;
              left: 0 !important;
              width: 100% !important;
              height: 100% !important;
              overflow: hidden !important;
              margin: 0 !important;
              padding: 0 !important;
            `;

            // Hide all direct children except modal
            Array.from(document.body.children).forEach(child => {
              if (!child.classList.contains('modal') && !child.classList.contains('modal-backdrop')) {
                child.style.display = 'none';
              }
            });
          }, 50);
        }
      });

      detailModalElement.addEventListener('shown.bs.modal', function() {
        // Ensure full screen on mobile and medium screen after modal is shown
        if (window.innerWidth <= 991.98) {
          detailModalElement.style.cssText = `
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 9999 !important;
            background: white !important;
          `;
        }
      });

      detailModalElement.addEventListener('hidden.bs.modal', function() {
        // Restore everything on mobile and medium screen
        if (window.innerWidth <= 991.98) {
          document.body.classList.remove('modal-open');
          document.body.style.cssText = '';

          // Show all hidden children
          Array.from(document.body.children).forEach(child => {
            if (!child.classList.contains('modal')) {
              child.style.display = '';
            }
          });
        }
        // Clean up the modal element
        detailModalElement.remove();
      });

      modal.show();

      // Initialize TSMC chart if it's the quantitative analysis
      if (currentFeatureType === 'quantitative') {
        // Wait for modal to be fully shown before initializing chart
        detailModalElement.addEventListener('shown.bs.modal', function() {
          initializeTSMCChart();
        }, { once: true });
      }
    }

    // Function to initialize TSMC stock price chart
    function initializeTSMCChart() {
      const ctx = document.getElementById('tsmcChart');
      if (!ctx) return;

      const dates = ['01/20', '01/21', '01/28', '02/03', '02/07', '02/10', '02/14', '02/20', '02/27'];
      const prices = [1120, 1095, 1108, 1058, 1071, 1056, 1048, 1035, 1040];
      const volumes = [45.2, 24.4, 38.6, 113.0, 67.5, 89.2, 52.3, 71.8, 45.7];

      // Event markers
      const eventPoints = [
        { x: 1, label: '地震影響', color: 'rgb(220, 53, 69)' },
        { x: 3, label: 'MSCI評估', color: 'rgb(255, 193, 7)' },
        { x: 5, label: 'MSCI調整', color: 'rgb(255, 193, 7)' }
      ];

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: dates,
          datasets: [
            {
              label: 'TSMC股價 (TWD)',
              data: prices,
              borderColor: 'rgb(220, 53, 69)',
              backgroundColor: 'rgba(220, 53, 69, 0.1)',
              borderWidth: 3,
              fill: true,
              tension: 0.2,
              pointRadius: 6,
              pointHoverRadius: 8,
              pointBackgroundColor: prices.map((_, index) => {
                if (eventPoints.some(event => event.x === index)) {
                  return eventPoints.find(event => event.x === index).color;
                }
                return 'rgb(220, 53, 69)';
              }),
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              yAxisID: 'y'
            },
            {
              label: '交易量 (千股)',
              data: volumes,
              type: 'bar',
              backgroundColor: 'rgba(74, 144, 164, 0.3)',
              borderColor: 'rgba(74, 144, 164, 0.8)',
              borderWidth: 1,
              yAxisID: 'y1'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          scales: {
            x: {
              display: true,
              title: {
                display: true,
                text: '日期 (2025年)',
                font: {
                  weight: 'bold'
                }
              },
              grid: {
                color: 'rgba(0, 0, 0, 0.1)'
              }
            },
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: '股價 (TWD)',
                font: {
                  weight: 'bold'
                }
              },
              min: 1000,
              max: 1150,
              grid: {
                color: 'rgba(0, 0, 0, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: {
                display: true,
                text: '交易量 (千股)',
                font: {
                  weight: 'bold'
                }
              },
              max: 120,
              grid: {
                drawOnChartArea: false,
              },
              ticks: {
                callback: function(value) {
                  return value + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                usePointStyle: true,
                padding: 20,
                font: {
                  size: 12
                }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: 'white',
              bodyColor: 'white',
              borderColor: 'rgba(255, 255, 255, 0.2)',
              borderWidth: 1,
              callbacks: {
                title: function(context) {
                  return '2025/' + context[0].label;
                },
                label: function(context) {
                  if (context.datasetIndex === 0) {
                    return '股價: ' + context.parsed.y.toLocaleString() + ' TWD';
                  } else {
                    return '交易量: ' + context.parsed.y + 'K股';
                  }
                },
                afterBody: function(context) {
                  const pointIndex = context[0].dataIndex;
                  const event = eventPoints.find(e => e.x === pointIndex);
                  return event ? ['', '📍 ' + event.label] : [];
                }
              }
            },
            annotation: {
              annotations: eventPoints.map(event => ({
                type: 'point',
                xValue: event.x,
                yValue: prices[event.x],
                backgroundColor: event.color,
                borderColor: '#fff',
                borderWidth: 2,
                radius: 8,
                label: {
                  display: true,
                  content: event.label,
                  position: 'top'
                }
              }))
            }
          },
          elements: {
            point: {
              hoverRadius: 8
            }
          }
        }
      });
    }

    // CSS for animations
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .option-card {
        opacity: 0;
      }
    `;
    document.head.appendChild(style);
  </script>
</body>

</html>