<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ•è³‡å› å­é‡åŒ–åˆ†æèˆ‡å°è‚¡å¯¦æˆ° | å®Œæ•´è¬›ç¾©</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --highlight-color: #e74c3c;
            --bg-color: #f8f9fa;
            --text-color: #333;
            --card-bg: #ffffff;
        }

        body {
            font-family: "PingFang TC", "Microsoft JhengHei", "Heiti TC", sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
        }

        header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 3rem 1rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 1rem;
        }

        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-3px);
        }

        h2 {
            border-left: 5px solid var(--accent-color);
            padding-left: 1rem;
            color: var(--primary-color);
            margin-top: 0;
        }

        h3 {
            color: var(--primary-color);
            margin-top: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .icon {
            margin-right: 0.5rem;
            font-size: 1.2em;
        }

        ul {
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        .highlight {
            color: var(--highlight-color);
            font-weight: bold;
        }

        .formula {
            background-color: #ecf0f1;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
            font-style: italic;
            text-align: center;
            font-size: 1.2rem;
            margin: 1rem 0;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            margin: 2rem 0;
        }

        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: bold;
            color: white;
            margin-right: 0.5rem;
        }
        .tag-value { background-color: #27ae60; }
        .tag-momentum { background-color: #e67e22; }
        .tag-size { background-color: #8e44ad; }
        .tag-quality { background-color: #2980b9; }

        footer {
            text-align: center;
            padding: 2rem;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #ddd;
        }
        
        /* Strategy Timeline Styles */
        .timeline {
            position: relative;
            max-width: 100%;
            margin: 20px auto;
        }
        .timeline-item {
            padding: 10px 20px;
            border-left: 3px solid var(--accent-color);
            margin-left: 10px;
            position: relative;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -9px;
            top: 18px;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: var(--accent-color);
        }
        
        @media (max-width: 600px) {
            header h1 { font-size: 1.8rem; }
            .card { padding: 1.5rem; }
        }
    </style>
</head>
<body>

<header>
    <h1>æŠ•è³‡å› å­é‡åŒ–åˆ†æèˆ‡å°è‚¡å¯¦æˆ°</h1>
    <p>å¾ç†è«–åŸºç¤åˆ°é«˜æ®–åˆ©ç‡ç­–ç•¥ Python å¯¦ä½œ</p>
</header>

<div class="container">

    <section class="card">
        <h2>ç¬¬ä¸€å–®å…ƒï¼šèªè­˜å› å­ (Factor Identification) ğŸ·ï¸</h2>
        <p>å› å­æ˜¯è§£é‡‹è³‡ç”¢å ±é…¬ç‡çš„ç‰¹å¾µã€‚é‡åŒ–æŠ•è³‡ä¸çœ‹ã€Œæ˜ç‰Œã€ï¼Œè€Œæ˜¯é€éæ•¸å­¸çµ±è¨ˆå°‹æ‰¾å…·å‚™é•·æœŸè¶…é¡å ±é…¬æ½›åŠ›çš„ç‰¹å¾µã€‚</p>
        
        <h3>æŠ•è³‡ç•Œçš„å…ƒç´ é€±æœŸè¡¨</h3>
        <div>
            <p><span class="tag tag-value">åƒ¹å€¼ Value</span> <strong>è²·å¾—ä¾¿å®œ</strong> (P/E, P/B) - å‡å€¼å›æ­¸é‚è¼¯ã€‚</p>
            <p><span class="tag tag-momentum">å‹•èƒ½ Momentum</span> <strong>å¼·è€…æ†å¼·</strong> (éå»å ±é…¬) - åˆ©ç”¨æŠ•è³‡äººåæ‡‰ä¸è¶³ã€‚</p>
            <p><span class="tag tag-size">è¦æ¨¡ Size</span> <strong>å°æå¤§</strong> (å¸‚å€¼) - é¢¨éšªæº¢é…¬è£œå„Ÿã€‚</p>
            <p><span class="tag tag-quality">å“è³ª Quality</span> <strong>é«”è³ªå„ªè‰¯</strong> (ROE, ESG) - é¿å…åƒ¹å€¼é™·é˜±ã€‚</p>
        </div>
        
        <div class="chart-container">
            <canvas id="factorChart"></canvas>
        </div>
        <p style="text-align: center; font-size: 0.9rem; color: #666;">*åœ–ç¤ºï¼šä¸åŒå› å­åœ¨é•·æœŸå¸‚å ´ä¸­çš„è¶…é¡å ±é…¬ç¤ºæ„ï¼ˆè™›æ“¬æ•¸æ“šï¼‰</p>
    </section>

    <section class="card">
        <h2>ç¬¬äºŒå–®å…ƒï¼šé©—è­‰å› å­ (Factor Verification) ğŸ§ª</h2>
        
        <h3>1. IC å€¼ (Information Coefficient)</h3>
        <p>åˆ¤æ–·å› å­æ˜¯å¦å…·å‚™é æ¸¬èƒ½åŠ›ã€‚</p>
        <div class="formula">
            IC = Correlation(Factor_Value<sub>t</sub>, Return<sub>t+1</sub>)
        </div>
        <ul>
            <li><strong>åˆ¤è®€æ¨™æº–ï¼š</strong>åœ¨å……æ»¿é›œè¨Šçš„è‚¡å¸‚ä¸­ï¼Œ<span class="highlight">IC > 0.05 (5%)</span> å³è¦–ç‚ºå„ªç§€å› å­ã€‚</li>
        </ul>

        <h3>2. åˆ†å±¤å›æ¸¬ (Layered Backtesting)</h3>
        <p>é€™æ˜¯ä¸€å€‹å„ªç§€å› å­æ‡‰è©²å‘ˆç¾çš„ã€Œå½©è™¹åœ–ã€ã€‚æœ€é«˜åˆ†çµ„ (Top) è¡¨ç¾æœ€å¥½ï¼Œæœ€ä½åˆ†çµ„ (Bottom) è¡¨ç¾æœ€å·®ï¼Œä¸”ä¸­é–“ä¸äº¤å‰ã€‚</p>
        
        <div class="chart-container">
            <canvas id="backtestChart"></canvas>
        </div>
    </section>

    <section class="card">
        <h2>ç¬¬ä¸‰å–®å…ƒï¼šçµ„åˆç­–ç•¥ (Portfolio Construction) ğŸ—ï¸</h2>
        <ul>
            <li><strong>å¤šå› å­æ¨¡å‹ï¼š</strong>çµ„åˆä½ç›¸é—œæ€§å› å­ä»¥æå‡å¤æ™®æ¯”ç‡ (Sharpe Ratio)ã€‚</li>
            <li><strong>æ¬Šé‡åˆ†é…ï¼š</strong>å¯¦å‹™ä¸Šï¼Œã€Œç°¡å–®å¹³å‡ (Equal Weighting)ã€å¾€å¾€æ¯”è¤‡é›œçš„æœ€ä½³åŒ–ç®—æ³•æ›´å…·é­¯æ£’æ€§ã€‚</li>
            <li><strong>é¢¨éšªæ§åˆ¶ (å¸‚å ´ä¸­æ€§)ï¼š</strong>åšå¤šå¼·å‹¢è‚¡ + æ”¾ç©ºå¤§ç›¤ = ç´”ç²¹çš„ Alpha (é¸è‚¡ç²åˆ©)ã€‚</li>
        </ul>
        <div class="formula">
            ç¸½å ±é…¬ = (å¸‚å ´æ¼²è·Œ Ã— Beta) + (é¸è‚¡èƒ½åŠ› Ã— Alpha)
        </div>
    </section>

    <section class="card">
        <h2>ç¬¬å››å–®å…ƒï¼šå°è‚¡å¯¦æˆ°æ¡ˆä¾‹â€”â€”é«˜æ®–åˆ©ç‡å‡å€¼å›æ­¸ ğŸ‡¹ğŸ‡¼</h2>
        <p>åˆ©ç”¨ã€Œè‚¡åƒ¹ä¸‹è·Œå°è‡´æ®–åˆ©ç‡é£†é«˜ã€çš„è¹ºè¹ºæ¿æ•ˆæ‡‰ï¼Œæ­é…é™¤æ¯è¡Œæƒ…çš„é€²å‡ºç­–ç•¥ã€‚</p>

        <h3>ç­–ç•¥æ™‚åºåœ–</h3>
        <div class="timeline">
            <div class="timeline-item">
                <strong>11æœˆ - 1æœˆ (å·¦å´ä½ˆå±€)</strong><br>
                åˆ©ç”¨ EPS æ¨ç®—é ä¼°è‚¡åˆ©ï¼Œæå‰åŸ‹ä¼ã€‚æ³¨æ„ï¼šéœ€ä½¿ç”¨ä¿å®ˆé…æ¯ç‡ (0.7) é¿å…ä¼°å€¼éé«˜ã€‚
            </div>
            <div class="timeline-item">
                <strong>3æœˆ - 4æœˆ (å³å´è¿½æ“Š)</strong><br>
                è‘£äº‹æœƒå®£å‘Šè‚¡åˆ©å¾Œï¼Œç¢ºèªæ®–åˆ©ç‡ > 5% ä¸”è‚¡åƒ¹æœªå™´å‡ºæ™‚è²·é€²ã€‚
            </div>
            <div class="timeline-item">
                <strong style="color: var(--highlight-color);">é™¤æ¯æ—¥å‰ 1 å¤© (å‡ºå ´)</strong><br>
                åŸ·è¡Œã€Œæ£„æ¯ä¿åƒ¹ã€ã€‚è³£å‡ºè‚¡ç¥¨ï¼Œé–å®šåƒ¹å·®ï¼Œé¿é–‹è‚¡åˆ©æ‰€å¾—ç¨…èˆ‡è²¼æ¯é¢¨éšªã€‚
            </div>
        </div>
    </section>

    <section class="card">
        <h2>ğŸ Python å¯¦ä½œç¯„æœ¬ (Pandas)</h2>
        <p>ä»¥ä¸‹ç¨‹å¼ç¢¼åŒ…å«äº†ã€Œä¿å®ˆç²åˆ©æ¨ç®—ã€èˆ‡ã€Œæ£„æ¯ä¿åƒ¹ã€çš„æ ¸å¿ƒé‚è¼¯ã€‚</p>
        <pre><code class="language-python">
import pandas as pd
import numpy as np

def high_yield_strategy_optimized(df):
    """
    è¼¸å…¥: df (åŒ…å« 'date', 'close', 'eps', 'ex_dividend_date' ç­‰æ¬„ä½)
    è¼¸å‡º: å¸¶æœ‰è²·è³£è¨Šè™Ÿçš„ DataFrame
    """
    
    # 1. æ•¸æ“šæº–å‚™
    df['date'] = pd.to_datetime(df['date'])
    df['ex_dividend_date'] = pd.to_datetime(df['ex_dividend_date'])
    
    # 2. è¨ˆç®—é ä¼°è‚¡åˆ© (ç²åˆ©æ¨ç®—)
    # è¨ˆç®—è¿‘å››å­£ EPS ç¸½å’Œ
    df['t12m_eps'] = df['eps'].rolling(window=4).sum()
    
    # [åƒæ•¸]ï¼šä¿å®ˆé…æ¯ç‡ (é‡å° 0050/æ¬Šå€¼è‚¡è¨­å®šå®‰å…¨é‚Šéš›)
    conservative_payout = 0.7
    
    df['estimated_dividend'] = df['t12m_eps'] * conservative_payout
    df['estimated_yield'] = df['estimated_dividend'] / df['close']
    
    # 3. ç”¢ç”Ÿé€²å ´è¨Šè™Ÿ (Buy Signal)
    # é‚è¼¯ï¼šä¿å®ˆé ä¼°æ®–åˆ©ç‡ > 5% ä¸” EPS > 0
    df['buy_signal'] = np.where(
        (df['estimated_yield'] > 0.05) & (df['t12m_eps'] > 0), 
        1, 0
    )
    
    # 4. ç”¢ç”Ÿå‡ºå ´è¨Šè™Ÿ (Exit Signal - æ£„æ¯ä¿åƒ¹)
    # è¨ˆç®—è·é›¢é™¤æ¯æ—¥é‚„æœ‰å¹¾å¤©
    df['days_to_ex'] = (df['ex_dividend_date'] - df['date']).dt.days
    
    # é‚è¼¯ï¼šåœ¨é™¤æ¯æ—¥ "å‰ 1 å¤©" è³£å‡º
    df['sell_signal'] = np.where(df['days_to_ex'] == 1, 1, 0)
    
    return df
        </code></pre>
    </section>

    <footer>
        <p>Â© 2025  Ai Fintecg Corp. é‡åŒ–ç§‘å­¸å¯¦é©—å®¤(Colab 1124INV01.py)</p>
        <p>å…è²¬è²æ˜ï¼šæœ¬å…§å®¹åƒ…ä¾›æ•™å­¸ç ”ç©¶ï¼Œä¸ä»£è¡¨ä»»ä½•æŠ•è³‡å»ºè­°ã€‚</p>
    </footer>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    // è¨­å®šå…¨åŸŸå­—å‹
    Chart.defaults.font.family = '"PingFang TC", "Microsoft JhengHei", sans-serif';

    // 1. å› å­è¡¨ç¾åœ– (Bar Chart)
    const ctxFactor = document.getElementById('factorChart').getContext('2d');
    new Chart(ctxFactor, {
        type: 'bar',
        data: {
            labels: ['åƒ¹å€¼ Value', 'å‹•èƒ½ Momentum', 'è¦æ¨¡ Size', 'å“è³ª Quality', 'å¸‚å ´å¤§ç›¤ Beta'],
            datasets: [{
                label: 'å¹´åŒ–è¶…é¡å ±é…¬ç‡ (Alpha) %',
                data: [4.5, 5.2, 2.1, 3.8, 0],
                backgroundColor: [
                    'rgba(39, 174, 96, 0.7)',
                    'rgba(230, 126, 34, 0.7)',
                    'rgba(142, 68, 173, 0.7)',
                    'rgba(41, 128, 185, 0.7)',
                    'rgba(149, 165, 166, 0.3)'
                ],
                borderColor: [
                    'rgba(39, 174, 96, 1)',
                    'rgba(230, 126, 34, 1)',
                    'rgba(142, 68, 173, 1)',
                    'rgba(41, 128, 185, 1)',
                    'rgba(149, 165, 166, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                title: { display: true, text: 'å„å› å­é•·æœŸè¶…é¡å ±é…¬ç¤ºæ„' }
            },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });

    // 2. åˆ†å±¤å›æ¸¬åœ– (Line Chart - The Rainbow)
    const ctxBacktest = document.getElementById('backtestChart').getContext('2d');
    
    // ç”Ÿæˆæ¨¡æ“¬æ•¸æ“šï¼šå–®èª¿æ€§ (Monotonic)
    const labels = ['2019', '2020', '2021', '2022', '2023'];
    
    new Chart(ctxBacktest, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Group 1 (æœ€é«˜åˆ†)',
                    data: [100, 120, 150, 140, 180],
                    borderColor: '#e74c3c', // Red (Top)
                    backgroundColor: '#e74c3c',
                    tension: 0.3
                },
                {
                    label: 'Group 2',
                    data: [100, 115, 135, 125, 150],
                    borderColor: '#e67e22', // Orange
                    backgroundColor: '#e67e22',
                    tension: 0.3
                },
                {
                    label: 'Group 3 (å¸‚å ´å¹³å‡)',
                    data: [100, 110, 120, 110, 130],
                    borderColor: '#f1c40f', // Yellow
                    backgroundColor: '#f1c40f',
                    tension: 0.3
                },
                {
                    label: 'Group 4',
                    data: [100, 105, 110, 95, 110],
                    borderColor: '#2ecc71', // Green
                    backgroundColor: '#2ecc71',
                    tension: 0.3
                },
                {
                    label: 'Group 5 (æœ€ä½åˆ†)',
                    data: [100, 95, 80, 70, 60],
                    borderColor: '#3498db', // Blue (Bottom)
                    backgroundColor: '#3498db',
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: { display: true, text: 'ç†æƒ³çš„å› å­åˆ†å±¤å›æ¸¬ (ç´¯ç©æ·¨å€¼)' }
            },
            interaction: {
                mode: 'index',
                intersect: false,
            },
        }
    });
</script>

</body>
</html>